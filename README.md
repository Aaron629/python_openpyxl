這段 Python 代碼利用 `openpyxl` 套件來處理 Excel 文件，主要功能包括：

1. 開啟 Excel (.xlsx):
   - 使用 `openpyxl.load_workbook()` 加載指定路徑的 Excel 文件。
2. 設置格式:
   - 對指定範圍的儲存格進行格式設置，包括字體 (`Font`)、對齊 (`Alignment`)、邊框 (`Border`)、填充 (`PatternFill`)、以及合併儲存格。
3. 動態插入列:
   - 根據資料的年份數量動態插入列，並顯示年度數據和計算百分比。
4. 填入資料:
   - 根據 `json_gender` 中的數據，在相應儲存格中填入人數和百分比值，並自動計算每年的合計值和總計。
5. 合併儲存格與插入函數公式**:
   - 對合計和百分比列進行合併，並設置相關公式來動態計算數據。
6. 設定字體顏色:
   - 將某些儲存格的字體顏色設置為紅色，並應用到第 7 行的所有相關儲存格。
7. 儲存檔案:
   - 將修改過的工作簿保存為一個新文件。
